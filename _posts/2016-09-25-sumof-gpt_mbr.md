---
title: 对于GPT和MBR系统引导的学习
categories:
  - Notes
tags:
  - System
date: 2016-09-25 21:20:04
permalink: sumof_gpt_mbr
---

<h2 id="intro">前言</h2>日前给一妹子装Ubuntu，几多波折，最主要的就是一开始没有意识到GPT+uefi的模式。

<!-- more -->

---------------

### 经验教训

用PE装WIN10的时候并不会报错，用镜像做启动盘才能看到报错，和BIOS设置有关。

`PE毁一生`

-------------

### GPT和MBR

mrb用于win平台，gpt主要用于mac（苹果），MBR分区表与GPT分区表的关系。

> 与支持最大卷为2 TB（Terabytes）并且每个磁盘最多有4个主分区（或3个主分区，1个扩展分区和无限制的逻辑驱动器）的MBR磁盘分区的样式相比，GPT磁盘分区样式支持最大卷为18 EB（Exabytes）并且每磁盘的分区数没有上限，只受到操作系统限制（`由于分区表本身需要占用一定空间，最初规划硬盘分区时，留给分区表的空间决定了最多可以有多少个分区`，IA-64版Windows限制最多有128个分区，这也是EFI标准规定的分区表的最小尺寸）。与MBR分区的磁盘不同，至关重要的平台操作数据位于分区，而不是位于非分区或隐藏扇区。另外，GPT分区磁盘有备份分区表来提高分区数据结构的完整性。

`解读`：

- GPT支持更大的分区，并且支持大于4个主分区
- uefi和legacy的速度没有很明显的比较，但是uefi毕竟是新一代的引导技术

--------------

### 目前Linux对uefi+GPT的支持

据说已经可以支持UEFI启动，对于GPT而言，多了一个boot/efi

注意的几点：

- secure boot
- 如果在安装Ubuntu系统的时候不是选择自动分区，而是选择最后那个“其它选项”来自定义分区，会发现其实Ubuntu提供的自定义分区功能很有限。它没办法让人选择是使用MBR分区还是使用GPT分区，也没有办法选择是否启用LVM。如果需要更灵活的管理的话，还是只有点击“试用Ubuntu”按钮，进入LiveCD的Ubuntu系统后，使用parted命令和lvm命令手动管理硬盘分区。

----------------

### 双系统中为什么选择了MBR

原因很简单，对于`MBR+legacy`的熟悉程度远大于uefi。

- 可以随意定制boot的位置，efi好像必须是一个单独的分区。
- 启动引导可以随意选择win的boot loader或者linux的grub or grub2
- 想怎么玩怎么玩

装机过程也选择了将GPT硬盘转化成MBR并重建MBR表。

**那么，GPT下如何实现WIN+linux双系统？（转载）**

1. ubuntu镜像（以ubuntu为例）需要是64位的，ubuntu官网有说明，他们只为64位版本添加了uefi启动模式
（判断镜像是否支持uefi启动很简单，不只是ubuntu，只要打开镜像，看其中是否有个efi文件夹，有就支持，没有就不支持）
2. 以uefi模式启动。虽然主板支持uefi，但从刻录好的U盘（或者光盘等其他介质）启动不一定采取uefi模式，以我电脑为例，开机按F12进入启动菜单选择时，分为两大类：uefi和lengcy。而U盘同时出现在两类启动中，这里需要选择uefi中的U盘
3. 选择引导安装设备。在ubuntu安装过程中，会让你选择将系统引导安装到哪里。传统的grub是安装到“sda"也就是整个硬盘的开始处，现在嘛，绝对不行！预装win8情况下，C盘前肯定会有2~3个小分区，其中一个就是用来存放efi文件以引导开机的。选择引导安装设备时ubuntu会列出当前所有分区，并且有注明分区类型，其中有一个标注为efi的就是此时要选择的

---------------

### GPT和MBR的无损转化

GPT到MBR比较简单，启动分区直接丢掉。

`MBR到GPT有一定风险`，系统需要重装，并且需要一个新的引导分区。

实际操作过程用的傲梅分区助手。

就酱。


